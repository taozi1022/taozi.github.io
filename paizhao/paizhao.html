
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <meta charset="UTF-8">

    <title> New Document </title>
    <meta name="Generator" content="EditPlus">
    <meta name="Author" content="">
    <meta name="Keywords" content="">
    <meta name="Description" content="">
</head>
<script src='jquery.min.js'></script>
<script>
    !function(){
        //缩放比例
        var defaultW = 375 ;
        if(/Android (d+.d+)/.test(navigator.userAgent)){
            var version=parseFloat(RegExp.$1);
            if(version>2.3){
                var phoneScale=parseInt(window.screen.width)/defaultW;
                document.write('<meta name="viewport" content="width='+defaultW+'", minimum-scale = '+phoneScale+", maximum-scale = "+phoneScale+', target-densitydpi=device-dpi">')
            }else{
                document.write('<meta name="viewport" content="width='+defaultW+'">')
            }
        }else{
            document.write('<meta name="viewport" content="width='+defaultW+', user-scalable=no">')
        };

    }();
    function selectimage(x,y){
        var flagTimeRandom = new Date().getTime()+""   , functionType = 0 ;
        var params = {
            "flagId":flagTimeRandom,
            "functionType":functionType,
            "nameSpace": "demo.systoon.com",
            "type":0,
            "ratio":0.4,
            "maxCount":1,
            "filterMimeType":"image/gif"
        };
        if(x && y){
            params.aspectX = x ;
            params.aspectY =y ;
            params.xLength = x ;
            params.yLength = y ;
        }

        window.location.href = "toon://bjrealname/selectimage?params=" + JSON.stringify(params);

        $.ajax({
            type: "post",
            data: 'params={"flagId":' + (flagTimeRandom) + '}',
            url: "//127.0.0.1:6780/getResult",
            dataType: "json",
            beforeSend:function(){
            },
            success: function (reg) {
                alert(JSON.stringify(reg))
                $("#showimg").attr("src","data:image/octet-stream;base64,"+ reg.data.base64)
            },
            error: function (e) {
                alert("错误")
            }
        });

    }

    function qrcode(){

        var params ={
            extUserId:"121111111111" ,
            cardId:"1111111111",
            cardTitle:"北京通卡二维码",
            flagId:new Date().getTime()+""
        }

        window.location.href = "toon://virtualcard/generateQRCode?params=" + JSON.stringify(params);
        $.ajax({
            type: "post",
            data: 'params={"flagId":' + (params.flagId) + '}',
            url: "//127.0.0.1:6780/getResult",
            dataType: "json",
            beforeSend:function(){
            },
            success: function (reg) {

                alert('success')
            },
            error: function (e) {
                alert("错误")
            }
        });

    }
    function paizhao(x,y){
        var flagTimeRandom = new Date().getTime()+"" , functionType = 0 ;
        var params = {
            "flagId":flagTimeRandom,
            "functionType":functionType,
            "nameSpace": "demo.systoon.com",
            "type":0,
            "ratio":0.4,
            "maxCount":1,
            "filterMimeType":"image/gif"
        };
        if(x && y){
            params.aspectX = x ;
            params.aspectY =y ;
            params.xLength = x ;
            params.yLength = y ;
        }

        var _wampPath = "bjrealname/bjRealNameTakePhoto" //此处为临时测试
        window.location.href = "toon://"+_wampPath+"?params=" + JSON.stringify(params);

        $.ajax({
            type: "post",
            data: 'params={"flagId":' + (flagTimeRandom) + '}',
            url: "//127.0.0.1:6780/getResult",
            dataType: "json",
            beforeSend:function(){
            },
            success: function (reg) {
                $("#showimg").attr("src","data:image/octet-stream;base64,"+ reg.data.base64)
            },
            error: function (e) {
                alert("错误")
            }
        });

    }
</script>
<body>
<button onclick="paizhao(141,225)">点击拍照(141,225)</button>
<button onclick="qrcode()">点击生成二维码</button>

<button onclick="selectimage(5,7)">选择照片(5:7)</button>
<button onclick="selectimage(3,2)">选择照片(3,2)</button>


<img id="showimg">
</body>
</html>
